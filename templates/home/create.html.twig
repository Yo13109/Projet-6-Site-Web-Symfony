{% extends "base.html.twig"  %}
{% form_theme formTrick 'bootstrap_4_layout.html.twig' %}
{% block body %}
	<div class="col-lg-8 offset-lg-1 col-md-12">
		<div class="card  mt-5">
			<div class="card-header">
				<h3>Creer une figure</h3>
			</div>
			<div class="card-content mb-5">
				{{ form_start(formTrick) }}

				{{ form_row(formTrick.name, {'attr':{'placeholder':"Nom de la figure"}}) }}
				{{ form_row(formTrick.content,{'attr':{'placeholder':"Contenu de la figure"}}) }}

				{{ form_row(formTrick.category) }}
				<div id="video" data-prototype="{{form_row(formTrick.video.vars.prototype)|e('html_attr')}}">
					{{ form_row(formTrick.video) }}
					<span></span>
				</div>

				{{ form_row(formTrick.pictures) }}

				

			</div>

			<button type="submit" class="btn btn-success">
				Ajouter la figure</button>
			{{ form_end(formTrick) }}
		</div>
	</div>
</div>{% endblock %}{% block javascripts %}
<script>
	let collection,
boutonAjout,
span;
window.onload = () => {
collection = document.querySelector("#video");
span = collection.querySelector("span");
boutonAjout = document.createElement("button");
boutonAjout.className = "ajout-video btn btn secondary";
boutonAjout.innerText = "Ajouter une video";

let nouveauBouton = span.append(boutonAjout);
collection.dataset.index = collection.querySelectorAll("input").length;
boutonAjout.addEventListener("click", function () {
addButton(collection, nouveauBouton);
})
function addButton(collection, nouveauBouton) {
let prototype = collection.dataset.prototype;
let index = collection.dataset.index;

prototype = prototype.replace(/__name__/g, index);
let content = document.createElement("url")
content.innerHtml = prototype;
let newForm = content.querySelector("div");
let boutonSupprimer = document.createElement("buttton");
boutonSupprimer.type = 'button';
boutonSupprimer.className = 'btn red';
boutonSupprimer.id = "-delete-video-" + index;
boutonSupprimer.innerText = "Supprimer cette video"
newForm.append(boutonSupprimer);

collection.dataset.index ++;
let boutonAjout = collection.querySelector("-ajout-video-");
span.insertBefore(newForm, boutonAjout);

}
}
</script>{% endblock %}
